<!DOCTYPE html>
<html lang="en">
<head>
  <meta charset="UTF-8">
  <meta name="viewport" content="width=device-width, initial-scale=1.0">
  <link rel="icon" type="image/png" sizes="32x32" href="/favicon-sales-32.png">
  <title>Lead Import ‚Äî Kande VendTech</title>
  <style>
    * { margin: 0; padding: 0; box-sizing: border-box; }
    :root {
      --bg: #f8fafc; --card: #ffffff; --border: #e2e8f0; --text: #0f172a;
      --muted: #64748b; --accent: #3b82f6; --accent-light: #eff6ff;
      --green: #22c55e; --green-light: #f0fdf4;
      --amber: #f59e0b; --amber-light: #fffbeb;
      --red: #ef4444; --red-light: #fef2f2;
      --purple: #8b5cf6; --purple-light: #f5f3ff;
      --radius: 12px;
    }
    body { font-family: -apple-system, BlinkMacSystemFont, 'Segoe UI', Roboto, sans-serif; background: var(--bg); color: var(--text); }
    .page { max-width: 1280px; margin: 0 auto; padding: 24px 28px 80px; }

    /* Header */
    .page-header {
      background: linear-gradient(135deg, #1e3a5f 0%, #2563eb 50%, #7c3aed 100%);
      border-radius: 16px; padding: 28px 32px; color: #fff; margin-bottom: 24px;
      position: relative; overflow: hidden;
    }
    .page-header::after {
      content: ''; position: absolute; top: -50%; right: -10%; width: 300px; height: 300px;
      background: radial-gradient(circle, rgba(255,255,255,0.08) 0%, transparent 70%); border-radius: 50%;
    }
    .page-header h1 { font-size: 1.5rem; font-weight: 700; margin-bottom: 4px; }
    .page-header p { font-size: 0.88rem; opacity: 0.8; }

    /* Cards */
    .card {
      background: var(--card); border: 1px solid var(--border); border-radius: var(--radius);
      padding: 20px 24px; margin-bottom: 20px;
    }
    .card-title { font-size: 0.95rem; font-weight: 700; margin-bottom: 14px; display: flex; align-items: center; gap: 8px; }

    /* File selector */
    .file-grid { display: grid; grid-template-columns: repeat(auto-fill, minmax(260px, 1fr)); gap: 12px; }
    .file-card {
      background: var(--bg); border: 2px solid var(--border); border-radius: 10px;
      padding: 16px; cursor: pointer; transition: all 0.15s;
    }
    .file-card:hover { border-color: var(--accent); background: var(--accent-light); }
    .file-card.selected { border-color: var(--accent); background: var(--accent-light); box-shadow: 0 0 0 3px rgba(59,130,246,0.15); }
    .file-card .file-name { font-weight: 700; font-size: 0.9rem; margin-bottom: 4px; word-break: break-all; }
    .file-card .file-meta { font-size: 0.78rem; color: var(--muted); display: flex; gap: 12px; }
    .file-card .file-count { font-weight: 700; color: var(--accent); }

    /* Action bar */
    .action-bar {
      display: flex; align-items: center; gap: 12px; flex-wrap: wrap; margin-bottom: 16px;
      padding: 14px 18px; background: var(--card); border: 1px solid var(--border);
      border-radius: var(--radius);
    }
    .action-bar .count { font-size: 0.85rem; color: var(--muted); }
    .action-bar .count strong { color: var(--text); }
    .spacer { flex: 1; }

    /* Buttons */
    .btn {
      display: inline-flex; align-items: center; gap: 6px;
      padding: 9px 18px; border: none; border-radius: 8px; cursor: pointer;
      font-size: 0.84rem; font-weight: 600; transition: all 0.15s;
      font-family: inherit; white-space: nowrap;
    }
    .btn:disabled { opacity: 0.5; cursor: not-allowed; }
    .btn-primary { background: var(--accent); color: #fff; }
    .btn-primary:hover:not(:disabled) { background: #2563eb; }
    .btn-success { background: var(--green); color: #fff; }
    .btn-success:hover:not(:disabled) { background: #16a34a; }
    .btn-outline { background: transparent; color: var(--muted); border: 1px solid var(--border); }
    .btn-outline:hover:not(:disabled) { background: var(--bg); color: var(--text); }
    .btn-sm { padding: 6px 12px; font-size: 0.78rem; }

    /* Filters */
    .filters { display: flex; gap: 8px; flex-wrap: wrap; margin-bottom: 12px; }
    .filter-chip {
      padding: 6px 14px; background: var(--bg); border: 1px solid var(--border);
      border-radius: 20px; font-size: 0.78rem; font-weight: 600; color: var(--muted);
      cursor: pointer; transition: all 0.15s;
    }
    .filter-chip:hover, .filter-chip.active { background: var(--accent-light); border-color: var(--accent); color: var(--accent); }
    .search-box {
      flex: 1; min-width: 180px; padding: 8px 14px; border: 1px solid var(--border);
      border-radius: 8px; font-size: 0.84rem; font-family: inherit; background: var(--card);
    }
    .search-box:focus { outline: none; border-color: var(--accent); box-shadow: 0 0 0 3px rgba(59,130,246,0.1); }

    /* Sort controls */
    .sort-controls { display: flex; gap: 6px; align-items: center; }
    .sort-controls label { font-size: 0.78rem; color: var(--muted); font-weight: 600; }
    .sort-controls select {
      padding: 6px 10px; border: 1px solid var(--border); border-radius: 6px;
      font-size: 0.78rem; font-family: inherit; background: var(--card);
    }

    /* Table */
    .table-wrap { overflow-x: auto; border-radius: var(--radius); border: 1px solid var(--border); }
    table { width: 100%; border-collapse: collapse; font-size: 0.84rem; }
    thead { background: var(--bg); position: sticky; top: 0; z-index: 1; }
    th {
      padding: 12px 14px; text-align: left; font-weight: 700; font-size: 0.75rem;
      text-transform: uppercase; letter-spacing: 0.5px; color: var(--muted);
      border-bottom: 2px solid var(--border); white-space: nowrap;
    }
    td { padding: 10px 14px; border-bottom: 1px solid #f1f5f9; vertical-align: top; }
    tr:hover td { background: #f8fafc; }
    tr.dup td { opacity: 0.5; text-decoration: line-through; }
    .cb-cell { width: 40px; text-align: center; }
    input[type="checkbox"] { width: 16px; height: 16px; accent-color: var(--accent); cursor: pointer; }

    /* Badges */
    .badge {
      display: inline-block; padding: 3px 8px; border-radius: 6px;
      font-size: 0.72rem; font-weight: 700; text-transform: uppercase;
    }
    .badge-high { background: var(--red-light); color: var(--red); }
    .badge-medium { background: var(--amber-light); color: var(--amber); }
    .badge-normal { background: #f1f5f9; color: var(--muted); }
    .badge-dup { background: var(--purple-light); color: var(--purple); }

    /* Score bar */
    .score-bar { display: flex; align-items: center; gap: 6px; }
    .score-fill {
      height: 6px; border-radius: 3px; background: var(--accent); min-width: 4px;
      transition: width 0.3s;
    }
    .score-track { flex: 1; height: 6px; background: #e2e8f0; border-radius: 3px; position: relative; overflow: hidden; min-width: 40px; }
    .score-num { font-size: 0.75rem; font-weight: 700; color: var(--accent); min-width: 24px; }

    /* Results banner */
    .results-banner {
      padding: 18px 22px; border-radius: var(--radius); margin-bottom: 20px;
      display: none; animation: slideIn 0.3s ease;
    }
    .results-banner.show { display: block; }
    .results-banner.success { background: var(--green-light); border: 1px solid #bbf7d0; }
    .results-banner.error { background: var(--red-light); border: 1px solid #fecaca; }
    .results-banner .results-title { font-weight: 700; font-size: 0.95rem; margin-bottom: 4px; }
    .results-banner .results-detail { font-size: 0.84rem; color: var(--muted); }
    .results-stats { display: flex; gap: 20px; margin-top: 8px; }
    .results-stat { text-align: center; }
    .results-stat .num { font-size: 1.4rem; font-weight: 800; }
    .results-stat .label { font-size: 0.72rem; color: var(--muted); text-transform: uppercase; }
    .results-stat .num.green { color: var(--green); }
    .results-stat .num.amber { color: var(--amber); }
    .results-stat .num.red { color: var(--red); }

    /* Loading */
    .loading { text-align: center; padding: 40px; color: var(--muted); }
    .spinner { display: inline-block; width: 24px; height: 24px; border: 3px solid #e2e8f0; border-top-color: var(--accent); border-radius: 50%; animation: spin 0.6s linear infinite; }
    @keyframes spin { to { transform: rotate(360deg); } }
    @keyframes slideIn { from { opacity: 0; transform: translateY(-8px); } to { opacity: 1; transform: translateY(0); } }

    /* Truncate */
    .trunc { max-width: 200px; white-space: nowrap; overflow: hidden; text-overflow: ellipsis; }
    .trunc-sm { max-width: 140px; white-space: nowrap; overflow: hidden; text-overflow: ellipsis; }

    /* Empty state */
    .empty { text-align: center; padding: 48px 20px; color: var(--muted); }
    .empty .icon { font-size: 2.4rem; margin-bottom: 12px; }
    .empty p { font-size: 0.9rem; }

    /* Responsive */
    @media (max-width: 768px) {
      .page { padding: 16px; }
      .page-header { padding: 20px 24px; }
      .page-header h1 { font-size: 1.25rem; }
      .file-grid { grid-template-columns: 1fr; }
      .action-bar { flex-direction: column; align-items: stretch; }
      .spacer { display: none; }
      th, td { padding: 8px 10px; font-size: 0.78rem; }
      .trunc, .trunc-sm { max-width: 120px; }
    }
  </style>
</head>
<body>
<script src="/nav.js"></script>

<div class="page">
  <div class="page-header">
    <h1>üì• Lead Bulk Import</h1>
    <p>Import leads from prospecting files into the CRM with automatic deduplication</p>
  </div>

  <!-- Results banner -->
  <div id="results-banner" class="results-banner"></div>

  <!-- Step 1: File Selection -->
  <div class="card">
    <div class="card-title">üìÅ Select Lead File</div>
    <div id="file-list" class="file-grid">
      <div class="loading"><div class="spinner"></div><br>Loading files‚Ä¶</div>
    </div>
  </div>

  <!-- Step 2: Preview & Filter -->
  <div id="preview-section" style="display:none;">
    <div class="action-bar">
      <label style="display:flex;align-items:center;gap:6px;cursor:pointer;">
        <input type="checkbox" id="select-all"> <span style="font-size:0.84rem;font-weight:600;">Select All</span>
      </label>
      <span class="count" id="selection-count">0 of 0 selected</span>
      <div class="spacer"></div>
      <div class="sort-controls">
        <label>Sort:</label>
        <select id="sort-by">
          <option value="priority">Priority</option>
          <option value="score">Score</option>
          <option value="name">Name</option>
          <option value="units">Units</option>
          <option value="type">Type</option>
        </select>
      </div>
      <button class="btn btn-success" id="import-btn" disabled>
        ‚¨ÜÔ∏è Import Selected
      </button>
    </div>

    <div class="filters">
      <input type="text" class="search-box" id="search-input" placeholder="üîç Search leads‚Ä¶">
      <span class="filter-chip active" data-filter="all">All</span>
      <span class="filter-chip" data-filter="high">üî• High Priority</span>
      <span class="filter-chip" data-filter="medium">üü° Medium</span>
      <span class="filter-chip" data-filter="normal">Normal</span>
      <span class="filter-chip" data-filter="dup">‚ö†Ô∏è Duplicates</span>
    </div>

    <div class="table-wrap">
      <table>
        <thead>
          <tr>
            <th class="cb-cell"><input type="checkbox" id="select-all-head"></th>
            <th>Name / Company</th>
            <th>Contact</th>
            <th>Address</th>
            <th>Type</th>
            <th>Units</th>
            <th>Priority</th>
            <th>Score</th>
            <th>Status</th>
          </tr>
        </thead>
        <tbody id="leads-tbody"></tbody>
      </table>
    </div>
    <div id="empty-state" class="empty" style="display:none;">
      <div class="icon">üîç</div>
      <p>No leads match your filters</p>
    </div>
  </div>
</div>

<script>
(function() {
  'use strict';

  var allLeads = [];
  var selectedFile = null;
  var existingProspects = [];
  var activeFilter = 'all';
  var currentSort = 'priority';

  // DOM refs
  var fileList = document.getElementById('file-list');
  var previewSection = document.getElementById('preview-section');
  var leadsTbody = document.getElementById('leads-tbody');
  var selectAll = document.getElementById('select-all');
  var selectAllHead = document.getElementById('select-all-head');
  var importBtn = document.getElementById('import-btn');
  var selectionCount = document.getElementById('selection-count');
  var searchInput = document.getElementById('search-input');
  var sortBy = document.getElementById('sort-by');
  var resultsBanner = document.getElementById('results-banner');
  var emptyState = document.getElementById('empty-state');
  var filterChips = document.querySelectorAll('.filter-chip');

  // Load existing prospects for dedup check
  function loadExistingProspects() {
    return fetch('/api/prospects').then(function(r) { return r.json(); }).then(function(data) {
      existingProspects = Array.isArray(data) ? data : [];
    }).catch(function() { existingProspects = []; });
  }

  // Check if a lead is a duplicate
  function isDuplicate(lead) {
    return existingProspects.some(function(p) {
      if (lead.address && p.address) {
        var nA = lead.address.toLowerCase().replace(/[.,#\-]/g, '').replace(/\s+/g, ' ').trim();
        var nB = p.address.toLowerCase().replace(/[.,#\-]/g, '').replace(/\s+/g, ' ').trim();
        if (nA === nB) return true;
      }
      if (lead.name && p.name) {
        if (lead.name.toLowerCase().trim() === p.name.toLowerCase().trim()) return true;
      }
      return false;
    });
  }

  // Load file list
  function loadFiles() {
    fetch('/api/lead-files').then(function(r) { return r.json(); }).then(function(files) {
      if (!files.length) {
        fileList.innerHTML = '<div class="empty"><div class="icon">üì≠</div><p>No lead files found in prospects directory</p></div>';
        return;
      }
      fileList.innerHTML = files.map(function(f) {
        var label = f.filename.replace(/^leads-/, '').replace(/-new\.json$|\.json$/, '').replace(/-/g, ' ');
        label = label.charAt(0).toUpperCase() + label.slice(1);
        var sizeKB = Math.round(f.size / 1024);
        return '<div class="file-card" data-file="' + f.filename + '">' +
          '<div class="file-name">üìÑ ' + label + '</div>' +
          '<div class="file-meta">' +
            '<span class="file-count">' + f.lead_count + ' leads</span>' +
            '<span>' + sizeKB + ' KB</span>' +
          '</div></div>';
      }).join('');

      // Attach click handlers
      fileList.querySelectorAll('.file-card').forEach(function(card) {
        card.addEventListener('click', function() {
          fileList.querySelectorAll('.file-card').forEach(function(c) { c.classList.remove('selected'); });
          card.classList.add('selected');
          loadLeadFile(card.getAttribute('data-file'));
        });
      });
    }).catch(function(e) {
      fileList.innerHTML = '<div class="empty"><div class="icon">‚ö†Ô∏è</div><p>Error loading files: ' + e.message + '</p></div>';
    });
  }

  // Load a specific lead file
  function loadLeadFile(filename) {
    selectedFile = filename;
    leadsTbody.innerHTML = '<tr><td colspan="9" class="loading"><div class="spinner"></div><br>Loading leads‚Ä¶</td></tr>';
    previewSection.style.display = 'block';
    resultsBanner.classList.remove('show');

    fetch('/api/lead-files/' + encodeURIComponent(filename)).then(function(r) { return r.json(); }).then(function(data) {
      allLeads = data.leads.map(function(lead, i) {
        lead._index = i;
        lead._selected = false;
        lead._isDup = isDuplicate(lead);
        if (!lead._isDup) lead._selected = true; // Auto-select non-duplicates
        return lead;
      });

      renderTable();
      updateSelectionCount();
      previewSection.scrollIntoView({ behavior: 'smooth', block: 'start' });
    }).catch(function(e) {
      leadsTbody.innerHTML = '<tr><td colspan="9" style="color:var(--red);padding:20px;">Error: ' + e.message + '</td></tr>';
    });
  }

  // Sorting
  function sortLeads(leads) {
    var sorted = leads.slice();
    var key = currentSort;
    sorted.sort(function(a, b) {
      if (key === 'priority') {
        var order = { high: 0, medium: 1, normal: 2 };
        var diff = (order[a.priority] || 2) - (order[b.priority] || 2);
        if (diff !== 0) return diff;
        return (b.score || 0) - (a.score || 0);
      }
      if (key === 'score') return (b.score || 0) - (a.score || 0);
      if (key === 'units') return (parseInt(b.units) || 0) - (parseInt(a.units) || 0);
      if (key === 'name') return (a.name || '').localeCompare(b.name || '');
      if (key === 'type') return (a.property_type || '').localeCompare(b.property_type || '');
      return 0;
    });
    return sorted;
  }

  // Filtering
  function filterLeads(leads) {
    var search = (searchInput.value || '').toLowerCase();
    return leads.filter(function(lead) {
      // Priority filter
      if (activeFilter === 'high' && lead.priority !== 'high') return false;
      if (activeFilter === 'medium' && lead.priority !== 'medium') return false;
      if (activeFilter === 'normal' && lead.priority !== 'normal') return false;
      if (activeFilter === 'dup' && !lead._isDup) return false;
      // Search
      if (search) {
        var haystack = [lead.name, lead.contact_name, lead.address, lead.property_type, lead.company, lead.email, lead.phone].join(' ').toLowerCase();
        if (haystack.indexOf(search) === -1) return false;
      }
      return true;
    });
  }

  // Render the table
  function renderTable() {
    var filtered = filterLeads(allLeads);
    var sorted = sortLeads(filtered);

    if (sorted.length === 0) {
      leadsTbody.innerHTML = '';
      emptyState.style.display = 'block';
      return;
    }
    emptyState.style.display = 'none';

    var maxScore = 1;
    allLeads.forEach(function(l) { if (l.score > maxScore) maxScore = l.score; });

    leadsTbody.innerHTML = sorted.map(function(lead) {
      var priClass = 'badge-' + lead.priority;
      var priLabel = lead.priority === 'high' ? 'üî• High' : lead.priority === 'medium' ? 'üü° Med' : 'Normal';
      var scorePct = maxScore > 0 ? Math.min(100, Math.round((lead.score / maxScore) * 100)) : 0;
      var dupClass = lead._isDup ? ' dup' : '';
      var statusBadge = lead._isDup ? '<span class="badge badge-dup">‚ö†Ô∏è Duplicate</span>' : '<span class="badge" style="background:#f0fdf4;color:#22c55e;">New</span>';

      return '<tr class="lead-row' + dupClass + '" data-index="' + lead._index + '">' +
        '<td class="cb-cell"><input type="checkbox" class="lead-cb" data-index="' + lead._index + '"' + (lead._selected ? ' checked' : '') + '></td>' +
        '<td><div style="font-weight:600;">' + esc(lead.name || '‚Äî') + '</div>' +
          (lead.company && lead.company !== lead.name ? '<div style="font-size:0.75rem;color:var(--muted);">' + esc(lead.company) + '</div>' : '') +
        '</td>' +
        '<td><div class="trunc-sm">' + esc(lead.contact_name || '‚Äî') + '</div>' +
          (lead.contact_title ? '<div style="font-size:0.72rem;color:var(--muted);" class="trunc-sm">' + esc(lead.contact_title) + '</div>' : '') +
          (lead.email ? '<div style="font-size:0.72rem;color:var(--accent);" class="trunc-sm">' + esc(lead.email) + '</div>' : '') +
        '</td>' +
        '<td class="trunc">' + esc(lead.address || '‚Äî') + '</td>' +
        '<td><span style="font-size:0.78rem;">' + esc(lead.property_type || '‚Äî') + '</span></td>' +
        '<td style="text-align:center;font-weight:600;">' + (lead.units || '‚Äî') + '</td>' +
        '<td><span class="badge ' + priClass + '">' + priLabel + '</span></td>' +
        '<td><div class="score-bar">' +
          '<span class="score-num">' + (lead.score || 0) + '</span>' +
          '<div class="score-track"><div class="score-fill" style="width:' + scorePct + '%;position:absolute;top:0;left:0;height:100%;"></div></div>' +
        '</div></td>' +
        '<td>' + statusBadge + '</td>' +
      '</tr>';
    }).join('');

    // Checkbox handlers
    leadsTbody.querySelectorAll('.lead-cb').forEach(function(cb) {
      cb.addEventListener('change', function() {
        var idx = parseInt(cb.getAttribute('data-index'));
        allLeads[idx]._selected = cb.checked;
        updateSelectionCount();
      });
    });
  }

  function esc(str) {
    if (!str) return '';
    var d = document.createElement('div');
    d.textContent = str;
    return d.innerHTML;
  }

  function updateSelectionCount() {
    var total = allLeads.filter(function(l) { return !l._isDup; }).length;
    var selected = allLeads.filter(function(l) { return l._selected && !l._isDup; }).length;
    var dupCount = allLeads.filter(function(l) { return l._isDup; }).length;
    selectionCount.innerHTML = '<strong>' + selected + '</strong> of ' + total + ' selected' +
      (dupCount > 0 ? ' ¬∑ <span style="color:var(--amber);">' + dupCount + ' duplicates</span>' : '');
    importBtn.disabled = selected === 0;
    var allNonDup = allLeads.filter(function(l) { return !l._isDup; });
    var allSelected = allNonDup.length > 0 && allNonDup.every(function(l) { return l._selected; });
    selectAll.checked = allSelected;
    selectAllHead.checked = allSelected;
  }

  // Select all
  function toggleSelectAll(checked) {
    allLeads.forEach(function(l) {
      if (!l._isDup) l._selected = checked;
    });
    renderTable();
    updateSelectionCount();
  }
  selectAll.addEventListener('change', function() { toggleSelectAll(selectAll.checked); });
  selectAllHead.addEventListener('change', function() { toggleSelectAll(selectAllHead.checked); });

  // Sort
  sortBy.addEventListener('change', function() {
    currentSort = sortBy.value;
    renderTable();
  });

  // Search
  var searchTimer;
  searchInput.addEventListener('input', function() {
    clearTimeout(searchTimer);
    searchTimer = setTimeout(function() { renderTable(); }, 200);
  });

  // Filter chips
  filterChips.forEach(function(chip) {
    chip.addEventListener('click', function() {
      filterChips.forEach(function(c) { c.classList.remove('active'); });
      chip.classList.add('active');
      activeFilter = chip.getAttribute('data-filter');
      renderTable();
    });
  });

  // Import
  importBtn.addEventListener('click', function() {
    var toImport = allLeads.filter(function(l) { return l._selected && !l._isDup; });
    if (toImport.length === 0) return;

    importBtn.disabled = true;
    importBtn.innerHTML = '<div class="spinner" style="width:16px;height:16px;border-width:2px;"></div> Importing‚Ä¶';

    fetch('/api/leads/import', {
      method: 'POST',
      headers: { 'Content-Type': 'application/json' },
      body: JSON.stringify({ leads: toImport })
    }).then(function(r) { return r.json(); }).then(function(result) {
      showResults(result);
      // Reload existing prospects for updated dedup
      loadExistingProspects().then(function() {
        // Re-check duplicates
        allLeads.forEach(function(l) { l._isDup = isDuplicate(l); l._selected = false; });
        renderTable();
        updateSelectionCount();
      });
    }).catch(function(e) {
      showResults({ error: e.message });
    }).finally(function() {
      importBtn.disabled = false;
      importBtn.innerHTML = '‚¨ÜÔ∏è Import Selected';
    });
  });

  function showResults(result) {
    if (result.error) {
      resultsBanner.className = 'results-banner show error';
      resultsBanner.innerHTML = '<div class="results-title">‚ùå Import Failed</div><div class="results-detail">' + esc(result.error) + '</div>';
      return;
    }

    resultsBanner.className = 'results-banner show success';
    resultsBanner.innerHTML =
      '<div class="results-title">‚úÖ Import Complete</div>' +
      '<div class="results-stats">' +
        '<div class="results-stat"><div class="num green">' + result.imported + '</div><div class="label">Imported</div></div>' +
        '<div class="results-stat"><div class="num amber">' + result.duplicates + '</div><div class="label">Skipped (Dup)</div></div>' +
        '<div class="results-stat"><div class="num red">' + (result.errors || 0) + '</div><div class="label">Errors</div></div>' +
        '<div class="results-stat"><div class="num">' + result.total + '</div><div class="label">Total</div></div>' +
      '</div>' +
      '<div class="results-detail" style="margin-top:10px;">' +
        '<a href="/crm" style="color:var(--accent);font-weight:600;">View in CRM ‚Üí</a>' +
      '</div>';

    resultsBanner.scrollIntoView({ behavior: 'smooth', block: 'start' });
  }

  // Init
  loadExistingProspects().then(loadFiles);
})();
</script>
</body>
</html>
